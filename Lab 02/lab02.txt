SELECT 'drop table '||table_name||' cascade constraints;' FROM user_tables;
DROP TABLE COUNTRIES CASCADE CONSTRAINTS;
DROP TABLE DEPARTMENTS CASCADE CONSTRAINTS;
DROP TABLE EMPLOYEES CASCADE CONSTRAINTS;
DROP TABLE JOBS CASCADE CONSTRAINTS;
DROP TABLE JOB_HISTORY CASCADE CONSTRAINTS;
DROP TABLE LOCATIONS CASCADE CONSTRAINTS;
DROP TABLE REGIONS CASCADE CONSTRAINTS;

SELECT * FROM sys.all_tables WHERE owner = 'HR';
CREATE TABLE COUNTRIES as (SELECT * FROM HR.COUNTRIES);
CREATE TABLE JOBS as (SELECT * FROM HR.JOBS);
CREATE TABLE REGIONS as (SELECT * FROM HR.REGIONS);
CREATE TABLE JOB_GRADES as (SELECT * FROM HR.JOB_GRADES);
CREATE TABLE EMPLOYEES as (SELECT * FROM HR.EMPLOYEES);
CREATE TABLE JOB_HISTORY as (SELECT * FROM HR.JOB_HISTORY);
CREATE TABLE DEPARTMENTS as (SELECT * FROM HR.DEPARTMENTS);
CREATE TABLE LOCATIONS as (SELECT * FROM HR.LOCATIONS);

ALTER TABLE REGIONS ADD PRIMARY KEY(region_id);
ALTER TABLE COUNTRIES ADD PRIMARY KEY(country_id);
ALTER TABLE COUNTRIES ADD FOREIGN KEY(region_id) REFERENCES REGIONS(region_id) ON DELETE CASCADE;
ALTER TABLE LOCATIONS ADD PRIMARY KEY(location_id);
ALTER TABLE LOCATIONS ADD FOREIGN KEY(country_id) REFERENCES COUNTRIES(country_id) ON DELETE CASCADE;
ALTER TABLE JOBS ADD PRIMARY KEY(job_id);
ALTER TABLE DEPARTMENTS ADD PRIMARY KEY(department_id);
ALTER TABLE EMPLOYEES ADD PRIMARY KEY(employee_id);
ALTER TABLE DEPARTMENTS ADD FOREIGN KEY(location_id) REFERENCES LOCATIONS(location_id) ON DELETE CASCADE;
ALTER TABLE DEPARTMENTS ADD FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id) ON DELETE CASCADE;
ALTER TABLE EMPLOYEES ADD FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id) ON DELETE CASCADE;
ALTER TABLE EMPLOYEES ADD FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id) ON DELETE CASCADE;
ALTER TABLE JOB_HISTORY ADD PRIMARY KEY(employee_id, start_date);
ALTER TABLE JOB_HISTORY ADD FOREIGN KEY(job_id) REFERENCES JOBS(job_id) ON DELETE CASCADE;
ALTER TABLE JOB_HISTORY ADD FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id) ON DELETE CASCADE;

SELECT last_name || ' ' || salary AS WYNAGRODZENIE FROM EMPLOYEES
    WHERE (department_id = 20 OR department_id = 50)
    AND (salary BETWEEN 2000 AND 7000) ORDER BY last_name;

SELECT hire_date, last_name, &Podaj FROM EMPLOYEES
    WHERE manager_id IS NOT NULL AND hire_date LIKE '05/%' ORDER BY &Sortuj;

SELECT first_name || ' ' || last_name AS NAME, salary, phone_number
    FROM EMPLOYEES WHERE last_name LIKE '__e%' AND first_name LIKE '&Imie'
    ORDER BY 1 DESC, 2 ASC;

SELECT first_name || ' ' || last_name AS Imie_Nazwisko,
    ROUND(MONTHS_BETWEEN(CURRENT_DATE, hire_date), 2) AS Miesiace_Przepracowane,
    CASE 
        WHEN MONTHS_BETWEEN(CURRENT_DATE, hire_date) < 150 THEN '10%'
        WHEN MONTHS_BETWEEN(CURRENT_DATE, hire_date) BETWEEN 150 AND 200 THEN '20%'
        WHEN MONTHS_BETWEEN(CURRENT_DATE, hire_date) > 200 THEN '30%'
    END AS Wysokosc_Dodatku FROM EMPLOYEES ORDER BY MONTHS_BETWEEN(CURRENT_DATE, hire_date);
