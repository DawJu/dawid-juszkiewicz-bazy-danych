SELECT department_name, SUM(salary) Sum, ROUND(AVG(salary), 0) Average
    FROM employees JOIN departments
    ON employees.department_id = departments.department_id
    GROUP BY department_name HAVING MIN(salary) > 5000;

SELECT e.last_name, e.department_id, d.department_name, e.job_id
    FROM employees e JOIN departments d ON e.department_id = d.department_id
    WHERE d.location_id = (
    SELECT location_id FROM locations WHERE city LIKE 'Toronto');

SELECT first_name || ' ' || last_name name FROM employees
    WHERE department_id IN (
    SELECT department_id FROM employees WHERE first_name LIKE 'Jennifer');

SELECT department_name FROM departments
    WHERE manager_id IS NULL;

SELECT e.first_name || ' ' || e.last_name name, e.job_id, d.department_name,
    e.salary, CASE
    WHEN salary BETWEEN jg.min_salary AND jg.max_salary THEN jg.grade
    END grade
    FROM job_grades jg, employees e RIGHT JOIN departments d ON e.department_id = d.department_id
    WHERE (CASE
    WHEN salary BETWEEN jg.min_salary AND jg.max_salary THEN jg.grade
    END) IS NOT NULL;

SELECT first_name, last_name, salary FROM employees
    WHERE salary > (SELECT AVG(salary) FROM employees)
    ORDER BY salary DESC;
    
SELECT employee_id, first_name, last_name FROM employees
    WHERE department_id IN (SELECT department_id FROM employees 
    WHERE last_name LIKE '%u%');
